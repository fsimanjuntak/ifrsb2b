package com.ibm.id.isat.usage.cs5

import org.apache.spark.SparkContext
import org.apache.spark.SparkConf
import scala.util.control.Breaks._
import org.apache.spark.sql.DataFrame
import org.apache.spark.sql.types.{StructType, StructField, StringType, IntegerType, DoubleType}
import org.apache.spark.sql.functions._

object CS5Schema {
   def main(args: Array[String]): Unit = {
    
    val sc = new SparkContext("local", "testing spark ", new SparkConf());
    val inputRDD = sc.textFile("C:/Users/IBM_ADMIN/Documents/BENA/GBS/Indosat/Hadoop/Hadoop New Development/Sample CS3/sample_conv_output_CS3.txt");
    
    println("Reference");
  }
  
    
  val CS5Schema = StructType(Array(
    StructField("TransactionDate", StringType, true),
    StructField("TransactionHour", StringType, true),
    StructField("MSISDN", StringType, true),
    StructField("CCNNode", StringType, true),
    StructField("APartyNumber", StringType, true),
    StructField("BPartyNumber", StringType, true),
    StructField("ServiceClass", StringType, true),
    StructField("CallClassCat", StringType, true),
    StructField("MSCAddress", StringType, true),
    StructField("OriginRealm", StringType, true),
    StructField("OriginHost", StringType, true),
    StructField("MCCMNC", StringType, true),
    StructField("LAC", StringType, true),
    StructField("CI", StringType, true),
    StructField("ECI", StringType, true),
    StructField("IMSI", StringType, true),
    StructField("APN", StringType, true),
    StructField("ServiceScenario", StringType, true),
    StructField("RoamingPosition", StringType, true),
    StructField("FAF", StringType, true),
    StructField("FAFNumber", StringType, true),
    StructField("RatingGroup", StringType, true),    
    StructField("ContentType", StringType, true),
    StructField("IMEI", StringType, true),    
    StructField("GGSNAddress", StringType, true),
    StructField("SGSNAddress", StringType, true),    
    StructField("CorrelationId", StringType, true),    
    StructField("ChargingId", StringType, true),
    StructField("RATType", StringType, true),        
    StructField("ServiceOfferId", StringType, true),    
    StructField("PaymentCategory", StringType, true),
    StructField("DedicatedAccountRow", StringType, true),
    StructField("DedicatedAccountValuesRow", StringType, true),
    StructField("AccountGroup", StringType, true),
    StructField("FAFName", StringType, true),
    StructField("AccountValueDeducted", StringType, true),
    StructField("Accumulator", StringType, true),
    StructField("CommunityId1", StringType, true),
    StructField("CommunityId2", StringType, true),
    StructField("CommunityId3", StringType, true),
    StructField("AccumulatedCost", DoubleType, true),
    StructField("Hit", IntegerType, true),
    StructField("UsageVolume", DoubleType, true),
    StructField("UsageDuration", DoubleType, true),
    StructField("IntcctAPartyNo", StringType, true),
    StructField("IntcctBPartyNo", StringType, true),
    StructField("SpOfrId", StringType, true),
    StructField("SpConsume", StringType, true),
    StructField("VasServiceId", StringType, true),
    StructField("TrafficCase", StringType, true),
    StructField("UsedOfferSC", StringType, true),
    StructField("OfferAttributeAreaname", StringType, true),
    StructField("CCRCCAAccountValueBefore", StringType, true),
    StructField("CCRCCAAccountValueAfter", StringType, true),
    StructField("ServiceUsageType", StringType, true),
    StructField("CCRTriggerTime", StringType, true),
    StructField("CCREventTime", StringType, true),
    StructField("JobId", StringType, true),
    StructField("RecordId", StringType, true),
    StructField("PrcDt", StringType, true),
    StructField("SourceType", StringType, true),
    StructField("FileName", StringType, true),
    StructField("FileDate", StringType, true),    
    StructField("MicroclusterId", StringType, true),
    StructField("NormCCRTriggerTime", StringType, true),
    StructField("SSPTransId", StringType, true),
    StructField("SubsLocNo", StringType, true),
    StructField("CGI", StringType, true),
    StructField("RsvFld2", StringType, true),
    StructField("RsvFld3", StringType, true),
    StructField("RsvFld4", StringType, true),
    StructField("RsvFld5", StringType, true),
    StructField("RsvFld6", StringType, true),
    StructField("RsvFld7", StringType, true),
    StructField("RsvFld8", StringType, true),
    StructField("RsvFld9", StringType, true),
    StructField("RsvFld10", StringType, true)
  ));
  
  val CS5Transpose = StructType(Array(
    StructField("TransactionDate", StringType, true),
    StructField("TransactionHour", StringType, true),
    StructField("MSISDN", StringType, true),
    StructField("CCNNode", StringType, true),
    StructField("APartyNumber", StringType, true),
    StructField("BPartyNumber", StringType, true),
    StructField("ServiceClass", StringType, true),
    StructField("CallClassCat", StringType, true),
    StructField("MSCAddress", StringType, true),
    StructField("OriginRealm", StringType, true),
    StructField("OriginHost", StringType, true),
    StructField("MCCMNC", StringType, true),
    StructField("LAC", StringType, true),
    StructField("CI", StringType, true),
    StructField("ECI", StringType, true),
    StructField("IMSI", StringType, true),
    StructField("APN", StringType, true),
    StructField("ServiceScenario", StringType, true),
    StructField("RoamingPosition", StringType, true),
    StructField("FAF", StringType, true),
    StructField("FAFNumber", StringType, true),
    StructField("RatingGroup", StringType, true),    
    StructField("ContentType", StringType, true),
    StructField("IMEI", StringType, true),    
    StructField("GGSNAddress", StringType, true),
    StructField("SGSNAddress", StringType, true),    
    StructField("CorrelationId", StringType, true),    
    StructField("ChargingId", StringType, true),
    StructField("RATType", StringType, true),        
    StructField("ServiceOfferId", StringType, true),    
    StructField("PaymentCategory", StringType, true),
    StructField("DedicatedAccountRow", StringType, true),
    StructField("DedicatedAccountValuesRow", StringType, true),
    StructField("AccountGroup", StringType, true),
    StructField("FAFName", StringType, true),
    StructField("AccountValueDeducted", StringType, true),
    StructField("Accumulator", StringType, true),
    StructField("CommunityId1", StringType, true),
    StructField("CommunityId2", StringType, true),
    StructField("CommunityId3", StringType, true),
    StructField("AccumulatedCost", DoubleType, true),
    StructField("Hit", IntegerType, true),
    StructField("UsageVolume", DoubleType, true),
    StructField("UsageDuration", DoubleType, true),
    StructField("IntcctAPartyNo", StringType, true),
    StructField("IntcctBPartyNo", StringType, true),
    StructField("SpOfrId", StringType, true),
    StructField("SpConsume", StringType, true),
    StructField("VasServiceId", StringType, true),
    StructField("TrafficCase", StringType, true),
    StructField("UsedOfferSC", StringType, true),
    StructField("OfferAttributeAreaname", StringType, true),
    StructField("CCRCCAAccountValueBefore", StringType, true),
    StructField("CCRCCAAccountValueAfter", StringType, true),
    StructField("ServiceUsageType", StringType, true),
    StructField("CCRTriggerTime", StringType, true),
    StructField("CCREventTime", StringType, true),    
    StructField("JobId", StringType, true),
    StructField("RecordId", StringType, true),
    StructField("PrcDt", StringType, true),
    StructField("SourceType", StringType, true),
    StructField("FileName", StringType, true),
    StructField("FileDate", StringType, true),    
    StructField("MicroclusterId", StringType, true),
    StructField("NormCCRTriggerTime", StringType, true),
    StructField("SSPTransId", StringType, true),
    StructField("SubsLocNo", StringType, true),
    StructField("CGI", StringType, true),
    StructField("RsvFld2", StringType, true),
    StructField("RsvFld3", StringType, true),
    StructField("RsvFld4", StringType, true),
    StructField("RsvFld5", StringType, true),
    StructField("RsvFld6", StringType, true),
    StructField("RsvFld7", StringType, true),
    StructField("RsvFld8", StringType, true),
    StructField("RsvFld9", StringType, true),
    StructField("RsvFld10", StringType, true),
     StructField("APrefix", StringType, true),
     StructField("ServiceCountryName", StringType, true),
     StructField("ServiceProviderId", StringType, true),
     StructField("ServiceCityName", StringType, true),
     StructField("BPrefix", StringType, true),
     StructField("DestinationCountryName", StringType, true),
     StructField("DestinationProviderId", StringType, true),
     StructField("DestinationCityName", StringType, true),
     StructField("callClassBase", StringType, true),
     StructField("callClassRuleId", StringType, true),
     StructField("callClassTariff", StringType, true),
     StructField("hlrBranchNm", StringType, true),
     StructField("hlrRegionNm", StringType, true),
     StructField("prmPkgCode", StringType, true),
     StructField("prmPkgName", StringType, true),
     StructField("brndSCName", StringType, true),
     StructField("mgrSvcClassId", StringType, true),
     StructField("offerAttrName", StringType, true),
     StructField("offerAttrValue", StringType, true),
     StructField("areaName", StringType, true),
     StructField("microclusterName", StringType, true),
     StructField("laciCluster", StringType, true),
     StructField("laciSalesArea", StringType, true),
     StructField("laciArea", StringType, true),
     StructField("laciMicroCluster", StringType, true),
     StructField("siteTech", StringType, true),
     StructField("laciRatType", StringType, true),
     StructField("revenueCodeBase", StringType, true),
     StructField("UsageAmount", DoubleType, true),
     StructField("DAUnitAmount", StringType, true),
     StructField("DAUnitUOM", StringType, true),
     StructField("TransposeId", StringType, true),
     StructField("Account", StringType, true)

  ));
  
    val CS5PostSchema = StructType(Array(
    StructField("MSISDN", StringType, true),
    StructField("TransactionDate", StringType, true),
    StructField("ServiceIdent", StringType, true),
    StructField("ServiceClass", StringType, true),
    StructField("ServiceScenario", StringType, true),
    StructField("RoamingPosition", StringType, true),
    StructField("FAF", StringType, true),
    StructField("DedicatedAccountRow", StringType, true),
    StructField("AccountValueDeducted", StringType, true),
    StructField("TreeDefinedFields", StringType, true),
    StructField("AccumulatedCost", DoubleType, true),
    StructField("BonusAdjustment", StringType, true),
    StructField("RecordNumber", StringType, true),
    StructField("ChargingContextId", StringType, true),
    StructField("FileName", StringType, true),
    StructField("OrigCCRTriggerTime", StringType, true),
    StructField("LAC", StringType, true),
    StructField("CI", StringType, true),
    StructField("APN", StringType, true),
    StructField("UsageDuration", DoubleType, true),
    StructField("UsageVolume", DoubleType, true),
    StructField("EventDuration", DoubleType, true),
    StructField("RatingGroup", StringType, true),    
    StructField("ContentType", StringType, true),
    StructField("RATType", StringType, true),
    StructField("IMEI", StringType, true),
    StructField("OrigCCREventTime", StringType, true),
    StructField("IMSI", StringType, true),
    StructField("GGSNAddress", StringType, true),
    StructField("SGSNAddress", StringType, true),
    StructField("MSCAddress", StringType, true),
    StructField("CorrelationId", StringType, true),  
    StructField("ChargingId", StringType, true),    
    StructField("OriginRealm", StringType, true),
    StructField("OriginHost", StringType, true),  
    StructField("OtherPartyNum", StringType, true),
    StructField("Costband", StringType, true),
    StructField("Calltype", StringType, true),
    StructField("CalltypeName", StringType, true),
    StructField("Location", StringType, true),
    StructField("Discount", StringType, true),
    StructField("RatTypeName", StringType, true),
    StructField("EventId", StringType, true),
    StructField("CCRTriggerTime", StringType, true),
    StructField("CCREventTime", StringType, true),
    StructField("DedicatedAccountValuesRow", StringType, true),
    StructField("VasServiceId", StringType, true),
    StructField("UsedOfferSC", StringType, true),
    StructField("OfferAttributeAreaname", StringType, true),
    StructField("CCRCCAAccountValueBefore", StringType, true),
    StructField("CCRCCAAccountValueAfter", StringType, true),
    StructField("CCNNode", StringType, true),
    StructField("CommunityId1", StringType, true),
    StructField("CommunityId2", StringType, true),
    StructField("CommunityId3", StringType, true),
    StructField("AccountGroup", StringType, true),
    StructField("ServiceOfferId", StringType, true),  
    StructField("SpOfrId", StringType, true),
    StructField("SpConsume", StringType, true),
    StructField("Accumulator", StringType, true),
    StructField("MCCMNC", StringType, true),    
    StructField("ECI", StringType, true),
    StructField("ServiceUsageType", StringType, true),    
    StructField("JobId", StringType, true),
    StructField("RecordId", StringType, true),
    StructField("PrcDt", StringType, true),
    StructField("SourceType", StringType, true),
    StructField("FileDate", StringType, true),
    StructField("SubsLocNo", StringType, true),
    StructField("SSPTransId", StringType, true), // Reserved Fields 1
    StructField("APartyNumber", StringType, true), // Reserved Fields 2
    StructField("NormCCRTriggerTime", StringType, true), // Reserved Fields 3
    StructField("RsvFld4", StringType, true),
    StructField("RsvFld5", StringType, true),
    StructField("RsvFld6", StringType, true),
    StructField("RsvFld7", StringType, true),
    StructField("RsvFld8", StringType, true),
    StructField("RsvFld9", StringType, true),
    StructField("RsvFld10", StringType, true)
  ));
    
     val CS5PostTranspose = StructType(Array(
    StructField("MSISDN", StringType, true),
    StructField("TransactionDate", StringType, true),
    StructField("ServiceIdent", StringType, true),
    StructField("ServiceClass", StringType, true),
    StructField("ServiceScenario", StringType, true),
    StructField("RoamingPosition", StringType, true),
    StructField("FAF", StringType, true),
    StructField("DedicatedAccountRow", StringType, true),
    StructField("AccountValueDeducted", StringType, true),
    StructField("TreeDefinedFields", StringType, true),
    StructField("AccumulatedCost", DoubleType, true),
    StructField("BonusAdjustment", StringType, true),
    StructField("RecordNumber", StringType, true),
    StructField("ChargingContextId", StringType, true),
    StructField("FileName", StringType, true),
    StructField("OrigCCRTriggerTime", StringType, true),
    StructField("LAC", StringType, true),
    StructField("CI", StringType, true),
    StructField("APN", StringType, true),
    StructField("UsageDuration", DoubleType, true),
    StructField("UsageVolume", DoubleType, true),
    StructField("EventDuration", DoubleType, true),
    StructField("RatingGroup", StringType, true),
    StructField("ContentType", StringType, true),
    StructField("RATType", StringType, true),
    StructField("IMEI", StringType, true),
    StructField("OrigCCREventTime", StringType, true),
    StructField("IMSI", StringType, true),
    StructField("GGSNAddress", StringType, true),
    StructField("SGSNAddress", StringType, true),
    StructField("MSCAddress", StringType, true),
    StructField("CorrelationId", StringType, true),
    StructField("ChargingId", StringType, true),
    StructField("OriginRealm", StringType, true),
    StructField("OriginHost", StringType, true),
    StructField("OtherPartyNum", StringType, true),
    StructField("Costband", StringType, true),
    StructField("Calltype", StringType, true),
    StructField("CalltypeName", StringType, true),
    StructField("Location", StringType, true),
    StructField("Discount", StringType, true),
    StructField("RatTypeName", StringType, true),
    StructField("EventId", StringType, true),
    StructField("CCRTriggerTime", StringType, true),
    StructField("CCREventTime", StringType, true),
    StructField("DedicatedAccountValuesRow", StringType, true),
    StructField("VasServiceId", StringType, true),
    StructField("UsedOfferSC", StringType, true),
    StructField("OfferAttributeAreaname", StringType, true),
    StructField("CCRCCAAccountValueBefore", StringType, true),
    StructField("CCRCCAAccountValueAfter", StringType, true),
    StructField("CCNNode", StringType, true),
    StructField("CommunityId1", StringType, true),
    StructField("CommunityId2", StringType, true),
    StructField("CommunityId3", StringType, true),
    StructField("AccountGroup", StringType, true),
    StructField("ServiceOfferId", StringType, true),  
    StructField("SpOfrId", StringType, true),
    StructField("SpConsume", StringType, true),
    StructField("Accumulator", StringType, true),
    StructField("MCCMNC", StringType, true),    
    StructField("ECI", StringType, true),
    StructField("ServiceUsageType", StringType, true),
    StructField("JobId", StringType, true),
    StructField("RecordId", StringType, true),
    StructField("PrcDt", StringType, true),
    StructField("SourceType", StringType, true),
    StructField("FileDate", StringType, true),
    StructField("SubsLocNo", StringType, true),
    StructField("RsvFld1", StringType, true),
    StructField("RsvFld2", StringType, true),
    StructField("RsvFld3", StringType, true),
    StructField("RsvFld4", StringType, true),
    StructField("RsvFld5", StringType, true),
    StructField("RsvFld6", StringType, true),
    StructField("RsvFld7", StringType, true),
    StructField("RsvFld8", StringType, true),
    StructField("RsvFld9", StringType, true),
    StructField("RsvFld10", StringType, true),
    StructField("APrefix", StringType, true),
    StructField("ServiceCountryName", StringType, true),
    StructField("ServiceProviderId", StringType, true),
    StructField("ServiceCityName", StringType, true),
    StructField("BPrefix", StringType, true),
    StructField("DestinationCountryName", StringType, true),
    StructField("DestinationProviderId", StringType, true),
    StructField("DestinationCityName", StringType, true),
    StructField("hlrBranchNm", StringType, true),
    StructField("hlrRegionNm", StringType, true),
    StructField("postSCName", StringType, true),
    StructField("CostbandName", StringType, true),
    StructField("LocationName", StringType, true),
    StructField("laciCluster", StringType, true),
    StructField("laciSalesArea", StringType, true),
    StructField("laciArea", StringType, true),
    StructField("laciMicroCluster", StringType, true),
    StructField("siteTech", StringType, true),
    StructField("laciRatType", StringType, true),
    StructField("PAxis1", StringType, true),
    StructField("PAxis2", StringType, true),
    StructField("PAxis3", StringType, true),
    StructField("PAxis4", StringType, true),
    StructField("PAxis5", StringType, true),
    StructField("RevenueCode", StringType, true),
    StructField("GLCode", StringType, true),
    StructField("GLName", StringType, true),
    StructField("ServiceType", StringType, true),
    StructField("ServiceTypeDA1", StringType, true),
    StructField("ServiceTypeNDA1", StringType, true),
    StructField("CorpUsgType", StringType, true),    
    StructField("UsageAmount", DoubleType, true),
     StructField("DAUnitAmount", StringType, true),
     StructField("DAUnitUOM", StringType, true),
     StructField("Account", StringType, true)
  ));
     
      val CS5PostAddonTranspose = StructType(Array(
    StructField("MSISDN", StringType, true),
    StructField("TransactionDate", StringType, true),
    StructField("ServiceIdent", StringType, true),
    StructField("ServiceClass", StringType, true),
    StructField("ServiceScenario", StringType, true),
    StructField("RoamingPosition", StringType, true),
    StructField("FAF", StringType, true),
    StructField("DedicatedAccountRow", StringType, true),
    StructField("AccountValueDeducted", StringType, true),
    StructField("TreeDefinedFields", StringType, true),
    StructField("AccumulatedCost", DoubleType, true),
    StructField("BonusAdjustment", StringType, true),
    StructField("RecordNumber", StringType, true),
    StructField("ChargingContextId", StringType, true),
    StructField("FileName", StringType, true),
    StructField("OrigCCRTriggerTime", StringType, true),
    StructField("LAC", StringType, true),
    StructField("CI", StringType, true),
    StructField("APN", StringType, true),
    StructField("UsageDuration", DoubleType, true),
    StructField("UsageVolume", DoubleType, true),
    StructField("EventDuration", DoubleType, true),
    StructField("RatingGroup", StringType, true),
    StructField("ContentType", StringType, true),
    StructField("RATType", StringType, true),
    StructField("IMEI", StringType, true),
    StructField("OrigCCREventTime", StringType, true),
    StructField("IMSI", StringType, true),
    StructField("GGSNAddress", StringType, true),
    StructField("SGSNAddress", StringType, true),
    StructField("MSCAddress", StringType, true),
    StructField("CorrelationId", StringType, true),
    StructField("ChargingId", StringType, true),
    StructField("OriginRealm", StringType, true),
    StructField("OriginHost", StringType, true),
    StructField("OtherPartyNum", StringType, true),
    StructField("Costband", StringType, true),
    StructField("Calltype", StringType, true),
    StructField("CalltypeName", StringType, true),
    StructField("Location", StringType, true),
    StructField("Discount", StringType, true),
    StructField("RatTypeName", StringType, true),
    StructField("EventId", StringType, true),
    StructField("CCRTriggerTime", StringType, true),
    StructField("CCREventTime", StringType, true),
    StructField("DedicatedAccountValuesRow", StringType, true),
    StructField("VasServiceId", StringType, true),
    StructField("UsedOfferSC", StringType, true),
    StructField("OfferAttributeAreaname", StringType, true),
    StructField("CCRCCAAccountValueBefore", StringType, true),
    StructField("CCRCCAAccountValueAfter", StringType, true),
    StructField("CCNNode", StringType, true),
    StructField("CommunityId1", StringType, true),
    StructField("CommunityId2", StringType, true),
    StructField("CommunityId3", StringType, true),
    StructField("AccountGroup", StringType, true),
    StructField("ServiceOfferId", StringType, true),  
    StructField("SpOfrId", StringType, true),
    StructField("SpConsume", StringType, true),
    StructField("Accumulator", StringType, true),
    StructField("MCCMNC", StringType, true),    
    StructField("ECI", StringType, true),
    StructField("ServiceUsageType", StringType, true),
    StructField("JobId", StringType, true),
    StructField("RecordId", StringType, true),
    StructField("PrcDt", StringType, true),
    StructField("SourceType", StringType, true),
    StructField("FileDate", StringType, true),
    StructField("SubsLocNo", StringType, true),
    StructField("SSPTransId", StringType, true),
    StructField("APartyNumber", StringType, true),
    StructField("NormCCRTriggerTime", StringType, true),
    StructField("RsvFld4", StringType, true),
    StructField("RsvFld5", StringType, true),
    StructField("RsvFld6", StringType, true),
    StructField("RsvFld7", StringType, true),
    StructField("RsvFld8", StringType, true),
    StructField("RsvFld9", StringType, true),
    StructField("RsvFld10", StringType, true),
    StructField("APrefix", StringType, true),
    StructField("ServiceCountryName", StringType, true),
    StructField("ServiceProviderId", StringType, true),
    StructField("ServiceCityName", StringType, true),
    StructField("BPrefix", StringType, true),
    StructField("DestinationCountryName", StringType, true),
    StructField("DestinationProviderId", StringType, true),
    StructField("DestinationCityName", StringType, true),
    StructField("hlrBranchNm", StringType, true),
    StructField("hlrRegionNm", StringType, true),
    StructField("postSCName", StringType, true),
    StructField("CostbandName", StringType, true),
    StructField("LocationName", StringType, true),
    StructField("laciCluster", StringType, true),
    StructField("laciSalesArea", StringType, true),
    StructField("laciArea", StringType, true),
    StructField("laciMicroCluster", StringType, true),
    StructField("siteTech", StringType, true),
    StructField("laciRatType", StringType, true),
    StructField("PAxis1", StringType, true),
    StructField("PAxis2", StringType, true),
    StructField("PAxis3", StringType, true),
    StructField("PAxis4", StringType, true),
    StructField("PAxis5", StringType, true),
    StructField("RevenueCode", StringType, true),
    StructField("GLCode", StringType, true),
    StructField("GLName", StringType, true),
    StructField("ServiceType", StringType, true),
    StructField("ServiceTypeDA1", StringType, true),
    StructField("ServiceTypeNDA1", StringType, true),
    StructField("CorpUsgType", StringType, true),    
    StructField("UsageAmount", DoubleType, true),
     StructField("DAUnitAmount", StringType, true),
     StructField("DAUnitUOM", StringType, true),
     StructField("Account", StringType, true)
  ));   
}
